<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>DecisionTreeRegressor (v2) | Cécile Gallioz’s blog on data science</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="DecisionTreeRegressor (v2)" />
<meta name="author" content="Cécile Gallioz" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Let’s play with data science! Deep Learning, scikit-learn, fastai and Python, we have plenty to do!" />
<meta property="og:description" content="Let’s play with data science! Deep Learning, scikit-learn, fastai and Python, we have plenty to do!" />
<link rel="canonical" href="https://cecilegallioz.github.io/blog/sklearn/v2/2022/03/07/SKLv2M2OverUnderFitting.html" />
<meta property="og:url" content="https://cecilegallioz.github.io/blog/sklearn/v2/2022/03/07/SKLv2M2OverUnderFitting.html" />
<meta property="og:site_name" content="Cécile Gallioz’s blog on data science" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-07T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://cecilegallioz.github.io/blog/sklearn/v2/2022/03/07/SKLv2M2OverUnderFitting.html","@type":"BlogPosting","headline":"DecisionTreeRegressor (v2)","dateModified":"2022-03-07T00:00:00-06:00","datePublished":"2022-03-07T00:00:00-06:00","author":{"@type":"Person","name":"Cécile Gallioz"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cecilegallioz.github.io/blog/sklearn/v2/2022/03/07/SKLv2M2OverUnderFitting.html"},"description":"Let’s play with data science! Deep Learning, scikit-learn, fastai and Python, we have plenty to do!","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://cecilegallioz.github.io/blog/feed.xml" title="Cécile Gallioz's blog on data science" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R5VX869VL0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-R5VX869VL0');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Cécile Gallioz&#39;s blog on data science</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">DecisionTreeRegressor (v2)</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-03-07T00:00:00-06:00" itemprop="datePublished">
        Mar 7, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Cécile Gallioz</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#sklearn">sklearn</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#v2">v2</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Loading">Loading </a></li>
<li class="toc-entry toc-h1"><a href="#Overfitting-:-bad-testing-error">Overfitting : bad testing error </a>
<ul>
<li class="toc-entry toc-h2"><a href="#R2">R2 </a></li>
<li class="toc-entry toc-h2"><a href="#neg_mean_absolute_error">neg_mean_absolute_error </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-03-07-SKLv2M2OverUnderFitting.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Loading">
<a class="anchor" href="#Loading" aria-hidden="true"><span class="octicon octicon-link"></span></a>Loading<a class="anchor-link" href="#Loading"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># import seaborn as sns</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_california_housing</span>

<span class="n">housing</span> <span class="o">=</span> <span class="n">fetch_california_housing</span><span class="p">(</span><span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">housing</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">housing</span><span class="o">.</span><span class="n">target</span>
<span class="n">target</span> <span class="o">*=</span> <span class="mi">100</span> <span class="c1"># rescale the target in k$</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The dataset data contains </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> samples and </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> features"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The dataset data contains 20640 samples and 8 features
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>MedInc        float64
HouseAge      float64
AveRooms      float64
AveBedrms     float64
Population    float64
AveOccup      float64
Latitude      float64
Longitude     float64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MedInc</th>
      <th>HouseAge</th>
      <th>AveRooms</th>
      <th>AveBedrms</th>
      <th>Population</th>
      <th>AveOccup</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.3252</td>
      <td>41.0</td>
      <td>6.984127</td>
      <td>1.023810</td>
      <td>322.0</td>
      <td>2.555556</td>
      <td>37.88</td>
      <td>-122.23</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.3014</td>
      <td>21.0</td>
      <td>6.238137</td>
      <td>0.971880</td>
      <td>2401.0</td>
      <td>2.109842</td>
      <td>37.86</td>
      <td>-122.22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.2574</td>
      <td>52.0</td>
      <td>8.288136</td>
      <td>1.073446</td>
      <td>496.0</td>
      <td>2.802260</td>
      <td>37.85</td>
      <td>-122.24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.6431</td>
      <td>52.0</td>
      <td>5.817352</td>
      <td>1.073059</td>
      <td>558.0</td>
      <td>2.547945</td>
      <td>37.85</td>
      <td>-122.25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.8462</td>
      <td>52.0</td>
      <td>6.281853</td>
      <td>1.081081</td>
      <td>565.0</td>
      <td>2.181467</td>
      <td>37.85</td>
      <td>-122.25</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    452.6
1    358.5
2    352.1
3    341.3
4    342.2
Name: MedHouseVal, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Median House Value (k$)"</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Target distribution"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Overfitting-:-bad-testing-error">
<a class="anchor" href="#Overfitting-:-bad-testing-error" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overfitting : bad testing error<a class="anchor-link" href="#Overfitting-:-bad-testing-error"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="R2">
<a class="anchor" href="#R2" aria-hidden="true"><span class="octicon octicon-link"></span></a>R2<a class="anchor-link" href="#R2"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">ShuffleSplit</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>
<span class="c1"># </span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">cv</span> <span class="o">=</span> <span class="n">ShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"test_score"</span><span class="p">]</span>
<span class="n">train_scores</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"train_score"</span><span class="p">]</span>
<span class="n">fit_time</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"fit_time"</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"The accuracy in TEST  is "</span>
      <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, for </span><span class="si">{</span><span class="n">fit_time</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"The accuracy in TRAIN is "</span>
      <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">train_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">train_scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The accuracy in TEST  is 0.605 +/- 0.014, for 0.106 seconds
The accuracy in TRAIN is 1.000 +/- 0.000
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">"r2"</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"test_score"</span><span class="p">]</span>
<span class="n">train_scores</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"train_score"</span><span class="p">]</span>
<span class="n">fit_time</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"fit_time"</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"The accuracy in TEST  is "</span>
      <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, for </span><span class="si">{</span><span class="n">fit_time</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"The accuracy in TRAIN is "</span>
      <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">train_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">train_scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The accuracy in TEST  is 0.605 +/- 0.014, for 0.106 seconds
The accuracy in TRAIN is 1.000 +/- 0.000
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="neg_mean_absolute_error">
<a class="anchor" href="#neg_mean_absolute_error" aria-hidden="true"><span class="octicon octicon-link"></span></a>neg_mean_absolute_error<a class="anchor-link" href="#neg_mean_absolute_error"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> 
                            <span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> 
                            <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> 
                            <span class="n">scoring</span><span class="o">=</span><span class="s2">"neg_mean_absolute_error"</span><span class="p">,</span>
                            <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cv_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cv_results</span><span class="p">)</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"test_score"</span><span class="p">]</span>
<span class="n">train_scores</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"train_score"</span><span class="p">]</span>

<span class="n">fit_time</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"fit_time"</span><span class="p">]</span>

<span class="n">scores</span> <span class="o">=</span> <span class="o">-</span><span class="n">cv_results</span><span class="p">[</span><span class="s2">"test_score"</span><span class="p">]</span>
<span class="n">train_scores</span> <span class="o">=</span> <span class="o">-</span><span class="n">cv_results</span><span class="p">[</span><span class="s2">"train_score"</span><span class="p">]</span>
<span class="n">fit_time</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">"fit_time"</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"The mean absolute error (k$) in TEST  is "</span>
      <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, for </span><span class="si">{</span><span class="n">fit_time</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"The mean absolute error (k$) in TRAIN is "</span>
      <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">train_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">train_scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The mean absolute error (k$) in TEST  is 46.266 +/- 0.961, for 0.109 seconds
The mean absolute error (k$) in TRAIN is 0.000 +/- 0.000
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="CecileGallioz/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/sklearn/v2/2022/03/07/SKLv2M2OverUnderFitting.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Let&#39;s play with data science! Deep Learning, scikit-learn, fastai and Python, we have plenty to do!</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
